{% extends 'base.html' %}
{% block title %}{{ page_title or 'Medusa – Startseite' }}{% endblock %}

{% block preface %}
<div class="start-ambient" aria-hidden="true">
    <div class="start-ambient__glow start-ambient__glow--left"></div>
    <div class="start-ambient__glow start-ambient__glow--right"></div>
    <div class="start-ambient__beam"></div>
</div>
{% endblock %}

{% block main %}
{% set hero_movies = hero_movies or [] %}
{% if not hero_movies %}
    {% set hero_movie = None %}
    {% for movies in categories.values() %}
        {% if movies and not hero_movie %}
            {% set hero_movie = movies[0] %}
        {% endif %}
    {% endfor %}
    {% if hero_movie %}
        {% set hero_movies = [hero_movie] %}
    {% endif %}
{% endif %}
{% set hero_first = hero_movies and hero_movies[0] or None %}
{% set hero_backdrop = hero_first and hero_first.backdrop_path and 'https://image.tmdb.org/t/p/original' + hero_first.backdrop_path or '' %}
{% set hero_poster = hero_first and hero_first.poster_path and 'https://image.tmdb.org/t/p/w500' + hero_first.poster_path or url_for('static', filename='images/poster-placeholder.svg') %}
{% set hero_overview = hero_first and hero_first.overview or 'Synchronisiere deine Bibliothek mit TMDB, durchstöbere Sammlungen und starte Streams aus einer eleganten Oberfläche.' %}
{% set hero_title = hero_first and hero_first.title or 'Willkommen bei Medusa' %}
{% set hero_movie_id = hero_first and hero_first.id %}
{% set recent_movies = categories.get('Neu hinzugefügt') or [] %}
{% set popular_movies = categories.get('Beliebt') or [] %}
{% set totals = namespace(count=0) %}
{% for movie_list in categories.values() %}
    {% set totals.count = totals.count + (movie_list|length) %}
{% endfor %}
{% set total_movies = totals.count %}

{% set hero_payload = namespace(items=[]) %}
{% for movie in hero_movies %}
    {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or url_for('static', filename='images/poster-placeholder.svg') %}
    {% set backdrop_url = movie.backdrop_path and 'https://image.tmdb.org/t/p/original' + movie.backdrop_path or movie.poster_path and 'https://image.tmdb.org/t/p/w1280' + movie.poster_path or poster_url %}
    {% set _ = hero_payload.items.append({
        'id': movie.id,
        'title': movie.title,
        'overview': movie.overview or '',
        'poster': poster_url,
        'backdrop': backdrop_url,
        'rating': movie.rating,
        'release_date': movie.release_date
    }) %}
{% endfor %}

{% set marquee_data = namespace(items=[], ids=[]) %}
{% for movie in hero_movies %}
    {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or movie.backdrop_path and 'https://image.tmdb.org/t/p/w780' + movie.backdrop_path or None %}
    {% if poster_url and movie.id not in marquee_data.ids %}
        {% set _ = marquee_data.ids.append(movie.id) %}
        {% set _ = marquee_data.items.append({'poster': poster_url, 'title': movie.title, 'meta': 'Hero'}) %}
    {% endif %}
{% endfor %}
{% for movie in popular_movies[:12] %}
    {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or movie.backdrop_path and 'https://image.tmdb.org/t/p/w780' + movie.backdrop_path or None %}
    {% if poster_url and movie.id not in marquee_data.ids %}
        {% set _ = marquee_data.ids.append(movie.id) %}
        {% set _ = marquee_data.items.append({'poster': poster_url, 'title': movie.title, 'meta': 'Beliebt'}) %}
    {% endif %}
{% endfor %}
{% for movie in recent_movies[:8] %}
    {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or movie.backdrop_path and 'https://image.tmdb.org/t/p/w780' + movie.backdrop_path or None %}
    {% if poster_url and movie.id not in marquee_data.ids %}
        {% set _ = marquee_data.ids.append(movie.id) %}
        {% set _ = marquee_data.items.append({'poster': poster_url, 'title': movie.title, 'meta': 'Neu'}) %}
    {% endif %}
{% endfor %}

<section class="surface hero" id="hero"{% if hero_backdrop %} style="--hero-image: url('{{ hero_backdrop }}');"{% endif %}{% if hero_movies %} data-hero-total="{{ hero_movies|length }}"{% endif %}>
    <div class="hero__backdrop"></div>
    <div class="hero__content">
        <div class="hero__pretitle">{{ hero_movies|length > 0 and 'Beliebt in deiner Bibliothek' or 'Weiter schauen' }}</div>
        <h1 class="hero__title">{{ hero_title }}</h1>
        <p class="hero__description">{{ hero_overview }}</p>
        <div class="hero__meta">
            {% if hero_first and hero_first.release_date %}
            {% set release_value = hero_first.release_date.strftime('%d.%m.%Y') if hero_first.release_date is not string and hero_first.release_date.strftime is not undefined else hero_first.release_date %}
            <span>
                <span class="material-symbols-outlined" aria-hidden="true">event</span>
                {{ release_value }}
            </span>
            {% endif %}
            {% if hero_first and hero_first.rating %}
            <span>
                <span class="material-symbols-outlined" aria-hidden="true">grade</span>
                {{ hero_first.rating|round(1) }}/10
            </span>
            {% endif %}
            <span>
                <span class="material-symbols-outlined" aria-hidden="true">video_library</span>
                {{ total_movies }} Titel gesamt
            </span>
        </div>
        <div class="hero__actions">
            <button class="btn btn-primary" id="detailHeroPlay" type="button"{% if hero_movie_id %} data-movie-id="{{ hero_movie_id }}"{% else %} disabled{% endif %}>
                <span class="material-symbols-outlined" aria-hidden="true">play_arrow</span>
                <span>Wiedergabe starten</span>
            </button>
            <button class="btn btn-ghost" id="refreshHero" type="button"{% if not hero_movies %} disabled{% endif %}>
                <span class="material-symbols-outlined" aria-hidden="true">skip_next</span>
                <span>Nächster Titel</span>
            </button>
        </div>
        {% if hero_movies|length > 1 %}
        <div class="hero__controls" role="group" aria-label="Hero Banner Steuerung">
            <button class="hero__control" type="button" data-hero-prev aria-label="Vorheriger Titel">
                <span class="material-symbols-outlined" aria-hidden="true">chevron_left</span>
            </button>
            <div class="hero__indicators" aria-hidden="true"></div>
            <button class="hero__control" type="button" data-hero-next aria-label="Nächster Titel">
                <span class="material-symbols-outlined" aria-hidden="true">chevron_right</span>
            </button>
        </div>
        {% endif %}
    </div>
    <div class="hero__poster">
        <div class="hero__poster-image" style="background-image: url('{{ hero_poster }}');"></div>
    </div>
    {% if hero_payload.items %}
    <script id="heroData" type="application/json">{{ hero_payload.items|tojson }}</script>
    {% endif %}
</section>

{% if marquee_data.items %}
<section class="poster-marquee" aria-label="Film- und Serienposter">
    <div class="poster-marquee__head">
        <span class="poster-marquee__icon material-symbols-outlined" aria-hidden="true">local_movies</span>
        <div>
            <h2 class="poster-marquee__title">Film & Serien Highlights</h2>
            <p class="poster-marquee__subtitle">Ein schneller Blick auf die beliebtesten Poster deiner Mediathek</p>
        </div>
    </div>
    <div class="poster-marquee__track">
        {% for item in marquee_data.items %}
        <figure class="poster-marquee__poster">
            <div class="poster-marquee__poster-image" style="background-image: url('{{ item.poster }}');"></div>
            <figcaption class="poster-marquee__caption">{{ item.title }}<span>{{ item.meta }}</span></figcaption>
        </figure>
        {% endfor %}
        {% for item in marquee_data.items %}
        <figure class="poster-marquee__poster">
            <div class="poster-marquee__poster-image" style="background-image: url('{{ item.poster }}');"></div>
            <figcaption class="poster-marquee__caption">{{ item.title }}<span>{{ item.meta }}</span></figcaption>
        </figure>
        {% endfor %}
    </div>
</section>
{% endif %}

{% set library_stats = [
    {'icon': 'collections_bookmark', 'label': 'Bibliothekstitel', 'value': total_movies, 'detail': 'Alle verfügbaren Filme & Serien in Medusa'},
    {'icon': 'auto_awesome', 'label': 'Beliebte Favoriten', 'value': popular_movies|length, 'detail': 'Top bewertete Inhalte aus deiner Sammlung'},
    {'icon': 'new_releases', 'label': 'Neu hinzugefügt', 'value': recent_movies|length, 'detail': 'Frisch synchronisierte Filme der letzten Zeit'},
    {'icon': 'link', 'label': 'Streaming-Links aktiv', 'value': scraped|length, 'detail': 'Direkte Quellen aus deinen Scraper-Integrationen'}
] %}
<section class="surface library-overview">
    <header class="section-head">
        <div>
            <h2>Deine Bibliothek im Überblick</h2>
            <p class="section-subtitle">Behalte Favoriten, Neuheiten und Stream-Links aus Medusa im Blick.</p>
        </div>
    </header>
    <div class="insight-grid">
        {% for stat in library_stats %}
        <article class="insight-card">
            <span class="insight-card__icon material-symbols-outlined" aria-hidden="true">{{ stat.icon }}</span>
            <div class="insight-card__content">
                <span class="insight-card__value">{{ stat.value }}</span>
                <span class="insight-card__label">{{ stat.label }}</span>
                <p class="insight-card__detail">{{ stat.detail }}</p>
            </div>
        </article>
        {% endfor %}
    </div>
</section>

{% set spotlight_recent = recent_movies and recent_movies[0] or None %}
{% set spotlight_recent_poster = spotlight_recent and spotlight_recent.poster_path and 'https://image.tmdb.org/t/p/w780' + spotlight_recent.poster_path or spotlight_recent and spotlight_recent.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + spotlight_recent.backdrop_path or url_for('static', filename='images/poster-placeholder.svg') %}
{% set spotlight_recent_backdrop = spotlight_recent and spotlight_recent.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + spotlight_recent.backdrop_path or spotlight_recent_poster %}
{% set spotlight_scraped_ns = namespace(item=None) %}
{% for link in scraped %}
    {% if link.movie and not spotlight_scraped_ns.item %}
        {% set spotlight_scraped_ns.item = link %}
    {% endif %}
{% endfor %}
{% set spotlight_scraped_link = spotlight_scraped_ns.item %}
{% set spotlight_scraped = spotlight_scraped_link and spotlight_scraped_link.movie or None %}
{% set spotlight_scraped_poster = spotlight_scraped and spotlight_scraped.poster_path and 'https://image.tmdb.org/t/p/w780' + spotlight_scraped.poster_path or spotlight_scraped and spotlight_scraped.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + spotlight_scraped.backdrop_path or url_for('static', filename='images/poster-placeholder.svg') %}
{% set spotlight_scraped_backdrop = spotlight_scraped and spotlight_scraped.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + spotlight_scraped.backdrop_path or spotlight_scraped_poster %}
{% set now_playing_highlight = now_playing_movies and now_playing_movies[0] or None %}
{% set now_playing_poster = now_playing_highlight and now_playing_highlight.poster_path and 'https://image.tmdb.org/t/p/w780' + now_playing_highlight.poster_path or now_playing_highlight and now_playing_highlight.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + now_playing_highlight.backdrop_path or url_for('static', filename='images/poster-placeholder.svg') %}
{% set now_playing_backdrop = now_playing_highlight and now_playing_highlight.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + now_playing_highlight.backdrop_path or now_playing_poster %}
{% if spotlight_recent or spotlight_scraped or now_playing_highlight %}
<section class="surface spotlight-section">
    <header class="section-head">
        <div>
            <h2>Highlights für heute</h2>
            <p class="section-subtitle">Kuratiert aus deinen Neuheiten, Scraper-Quellen und den aktuellen Kinostarts.</p>
        </div>
    </header>
    <div class="spotlight-grid">
        {% if spotlight_recent %}
        <article class="spotlight-card card" role="button" tabindex="0"
                 data-movie-id="{{ spotlight_recent.id }}"
                 data-title="{{ spotlight_recent.title }}"
                 data-overview="{{ spotlight_recent.overview|default('')|e }}"
                 data-backdrop="{{ spotlight_recent_backdrop }}"
                 data-poster="{{ spotlight_recent_poster }}"
                 data-release="{{ spotlight_recent.release_date or '' }}">
            <div class="spotlight-card__background" style="--spotlight-image: url('{{ spotlight_recent_backdrop }}');"></div>
            <div class="spotlight-card__content">
                <span class="spotlight-card__badge">
                    <span class="material-symbols-outlined" aria-hidden="true">fiber_new</span>
                    Neu in deiner Mediathek
                </span>
                <h3>{{ spotlight_recent.title }}</h3>
                <p>{{ spotlight_recent.overview|default('Keine Beschreibung verfügbar.')|truncate(150) }}</p>
                <div class="spotlight-card__actions">
                    <button class="btn btn-primary view-detail" type="button" data-movie-id="{{ spotlight_recent.id }}">
                        <span class="material-symbols-outlined" aria-hidden="true">play_circle</span>
                        Details ansehen
                    </button>
                    <a class="spotlight-card__link" href="{{ url_for('filme') }}" data-navigation="route">Filme erkunden</a>
                </div>
            </div>
        </article>
        {% endif %}
        {% if spotlight_scraped %}
        <article class="spotlight-card card" role="button" tabindex="0"
                 data-movie-id="{{ spotlight_scraped.id }}"
                 data-title="{{ spotlight_scraped.title }}"
                 data-overview="{{ spotlight_scraped.overview|default('')|e }}"
                 data-backdrop="{{ spotlight_scraped_backdrop }}"
                 data-poster="{{ spotlight_scraped_poster }}"
                 data-release="{{ spotlight_scraped.release_date or '' }}">
            <div class="spotlight-card__background" style="--spotlight-image: url('{{ spotlight_scraped_backdrop }}');"></div>
            <div class="spotlight-card__content">
                <span class="spotlight-card__badge">
                    <span class="material-symbols-outlined" aria-hidden="true">link</span>
                    {{ spotlight_scraped_link.source_name }}{% if spotlight_scraped_link.mirror_info %} · {{ spotlight_scraped_link.mirror_info }}{% endif %}
                </span>
                <h3>{{ spotlight_scraped.title }}</h3>
                <p>{{ spotlight_scraped.overview|default('Direkter Stream aus deiner Scraper-Integration.')|truncate(150) }}</p>
                <div class="spotlight-card__actions">
                    <button class="btn btn-secondary view-detail" type="button" data-movie-id="{{ spotlight_scraped.id }}">
                        <span class="material-symbols-outlined" aria-hidden="true">play_arrow</span>
                        Stream starten
                    </button>
                    <a class="spotlight-card__link" href="{{ url_for('scraper_view') }}" data-navigation="route">Scraper verwalten</a>
                </div>
            </div>
        </article>
        {% endif %}
        {% if now_playing_highlight %}
        <article class="spotlight-card card" role="button" tabindex="0"
                 data-movie-id="{{ now_playing_highlight.id }}"
                 data-title="{{ now_playing_highlight.title }}"
                 data-overview="{{ now_playing_highlight.overview|default('')|e }}"
                 data-backdrop="{{ now_playing_backdrop }}"
                 data-poster="{{ now_playing_poster }}"
                 data-release="{{ now_playing_highlight.release_date or '' }}">
            <div class="spotlight-card__background" style="--spotlight-image: url('{{ now_playing_backdrop }}');"></div>
            <div class="spotlight-card__content">
                <span class="spotlight-card__badge">
                    <span class="material-symbols-outlined" aria-hidden="true">movie_filter</span>
                    Aktuell im Kino
                </span>
                <h3>{{ now_playing_highlight.title }}</h3>
                <p>{{ now_playing_highlight.overview|default('Starte direkt aus deiner Bibliothek.')|truncate(150) }}</p>
                <div class="spotlight-card__actions">
                    <button class="btn btn-ghost view-detail" type="button" data-movie-id="{{ now_playing_highlight.id }}">
                        <span class="material-symbols-outlined" aria-hidden="true">info</span>
                        Mehr erfahren
                    </button>
                    <a class="spotlight-card__link" href="#hero">Zum Hero-Titel</a>
                </div>
            </div>
        </article>
        {% endif %}
    </div>
</section>
{% endif %}

{% if now_playing_movies %}
<section class="surface media-rail media-rail--highlight" data-rail>
    <header class="section-head">
        <div>
            <h2>Aktuell im Kino</h2>
            <p class="section-subtitle">Beliebte Kinofilme, die bereits in deiner Bibliothek verfügbar sind</p>
        </div>
        <div class="rail-controls">
            <button type="button" class="rail-button" data-rail-prev aria-label="Zurück"><span class="material-symbols-outlined">chevron_left</span></button>
            <button type="button" class="rail-button" data-rail-next aria-label="Weiter"><span class="material-symbols-outlined">chevron_right</span></button>
        </div>
    </header>
    <div class="media-rail__track" data-rail-track>
        {% for movie in now_playing_movies %}
        {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or url_for('static', filename='images/poster-placeholder.svg') %}
        {% set backdrop_url = movie.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + movie.backdrop_path or '' %}
        <article class="media-card" role="button" tabindex="0"
                 data-movie-id="{{ movie.id }}"
                 data-title="{{ movie.title }}"
                 data-overview="{{ movie.overview|default('')|e }}"
                 data-backdrop="{{ backdrop_url }}"
                 data-poster="{{ poster_url }}"
                 data-release="{{ movie.release_date or '' }}">
            <div class="media-card__poster" style="background-image: url('{{ poster_url }}');"></div>
            <div class="media-card__overlay">
                <h3 class="media-card__title">{{ movie.title }}</h3>
                <p class="media-card__meta">{{ movie.release_date or 'Unbekannt' }}</p>
                <span class="media-card__badge">Im Kino</span>
            </div>
        </article>
        {% endfor %}
    </div>
</section>
{% endif %}

<section class="surface media-promos">
    <header class="section-head">
        <div>
            <h2>Meine Medien</h2>
            <p class="section-subtitle">Direkter Zugriff auf Filme, Serien und TMDB</p>
        </div>
    </header>
    <div class="promo-grid">
        <a href="{{ url_for('filme') }}" class="promo-card" data-navigation="route">
            <span class="promo-card__icon material-symbols-outlined" aria-hidden="true">local_movies</span>
            <div class="promo-card__content">
                <span class="promo-card__title">Filme</span>
                <span class="promo-card__description">Durchstöbere deine komplette Filmsammlung.</span>
            </div>
        </a>
        <a href="{{ url_for('serien') }}" class="promo-card" data-navigation="route">
            <span class="promo-card__icon material-symbols-outlined" aria-hidden="true">tv</span>
            <div class="promo-card__content">
                <span class="promo-card__title">Serien</span>
                <span class="promo-card__description">Alle Serien an einem Ort gesammelt.</span>
            </div>
        </a>
        <a href="https://www.themoviedb.org/" class="promo-card" rel="noreferrer">
            <span class="promo-card__icon material-symbols-outlined" aria-hidden="true">travel_explore</span>
            <div class="promo-card__content">
                <span class="promo-card__title">TMDB</span>
                <span class="promo-card__description">Neue Highlights direkt aus der TMDB Datenbank.</span>
            </div>
        </a>
    </div>
</section>

{% set default_titles = ['Weiterschauen', 'Als nächstes?', 'Kürzlich hinzugefügt'] %}
{% for section in film_sections %}
    {% if section['items'] %}
    {% set display_title = default_titles[loop.index0] if loop.index0 < default_titles|length else section.title %}
    <section class="surface media-rail" data-rail>
        <header class="section-head">
            <div>
                <h2>{{ display_title }}</h2>
                <p class="section-subtitle">{{ section.title }}</p>
            </div>
            <div class="rail-controls">
                <button type="button" class="rail-button" data-rail-prev aria-label="Zurück"><span class="material-symbols-outlined">chevron_left</span></button>
                <button type="button" class="rail-button" data-rail-next aria-label="Weiter"><span class="material-symbols-outlined">chevron_right</span></button>
            </div>
        </header>
        <div class="media-rail__track" data-rail-track>
            {% for movie in section['items'] %}
            {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or url_for('static', filename='images/poster-placeholder.svg') %}
            {% set backdrop_url = movie.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + movie.backdrop_path or '' %}
            <article class="media-card" role="button" tabindex="0"
                     data-movie-id="{{ movie.id }}"
                     data-title="{{ movie.title }}"
                     data-overview="{{ movie.overview|default('')|e }}"
                     data-backdrop="{{ backdrop_url }}"
                     data-poster="{{ poster_url }}"
                     data-release="{{ movie.release_date or '' }}">
                <div class="media-card__poster" style="background-image: url('{{ poster_url }}');"></div>
                <div class="media-card__overlay">
                    <h3 class="media-card__title">{{ movie.title }}</h3>
                    <p class="media-card__meta">{{ movie.release_date or 'Unbekannt' }}</p>
                    <span class="media-card__rating">⭐ {{ (movie.rating or 0)|round(1) }}</span>
                </div>
            </article>
            {% endfor %}
        </div>
    </section>
    {% endif %}
{% endfor %}

{% if scraped %}
<section class="surface media-rail" data-rail>
    <header class="section-head">
        <div>
            <h2>Als nächstes?</h2>
            <p class="section-subtitle">Neu aus den Scraper-Quellen</p>
        </div>
        <div class="rail-controls">
            <button type="button" class="rail-button" data-rail-prev aria-label="Zurück"><span class="material-symbols-outlined">chevron_left</span></button>
            <button type="button" class="rail-button" data-rail-next aria-label="Weiter"><span class="material-symbols-outlined">chevron_right</span></button>
        </div>
    </header>
    <div class="media-rail__track" data-rail-track>
        {% for link in scraped %}
        {% set movie = link.movie %}
        {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or url_for('static', filename='images/poster-placeholder.svg') %}
        {% set backdrop_url = movie.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + movie.backdrop_path or '' %}
        <article class="media-card" role="button" tabindex="0"
                 data-movie-id="{{ movie.id }}"
                 data-title="{{ movie.title }}"
                 data-overview="{{ movie.overview|default('')|e }}"
                 data-backdrop="{{ backdrop_url }}"
                 data-poster="{{ poster_url }}"
                 data-release="{{ movie.release_date or '' }}">
            <div class="media-card__poster" style="background-image: url('{{ poster_url }}');"></div>
            <div class="media-card__overlay">
                <h3 class="media-card__title">{{ movie.title }}</h3>
                <p class="media-card__meta">{{ link.source_name }}{% if link.mirror_info %} · {{ link.mirror_info }}{% endif %}</p>
                <span class="media-card__badge">Scraper</span>
            </div>
        </article>
        {% endfor %}
    </div>
</section>
{% endif %}

{% if recent_movies %}
<section class="surface media-grid-block">
    <header class="section-head">
        <div>
            <h2>Kürzlich hinzugefügt in Filme</h2>
            <p class="section-subtitle">Frisch synchronisierte Highlights deiner Bibliothek</p>
        </div>
        <a class="section-link" href="{{ url_for('filme_all') }}" data-navigation="route">Alle anzeigen</a>
    </header>
    <div class="media-grid">
        {% for movie in recent_movies[:12] %}
        {% set poster_url = movie.poster_path and 'https://image.tmdb.org/t/p/w500' + movie.poster_path or url_for('static', filename='images/poster-placeholder.svg') %}
        {% set backdrop_url = movie.backdrop_path and 'https://image.tmdb.org/t/p/w1280' + movie.backdrop_path or '' %}
        <article class="media-card media-card--grid" role="button" tabindex="0"
                 data-movie-id="{{ movie.id }}"
                 data-title="{{ movie.title }}"
                 data-overview="{{ movie.overview|default('')|e }}"
                 data-backdrop="{{ backdrop_url }}"
                 data-poster="{{ poster_url }}"
                 data-release="{{ movie.release_date or '' }}">
            <div class="media-card__poster" style="background-image: url('{{ poster_url }}');"></div>
            <div class="media-card__overlay">
                <h3 class="media-card__title">{{ movie.title }}</h3>
            </div>
        </article>
        {% endfor %}
    </div>
</section>
{% endif %}
{% endblock %}
